(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/wm-poster/wm-posters"],{794:
/*!**************************************************************!*\
  !*** C:/work/haisheng_m/components/wm-poster/wm-posters.vue ***!
  \**************************************************************/
/*! no static exports found */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./wm-posters.vue?vue&type=template&id=781f1a55& */795),a=n(/*! ./wm-posters.vue?vue&type=script&lang=js& */797);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var c,u=n(/*! ../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */10),o=Object(u["default"])(a["default"],r["render"],r["staticRenderFns"],!1,null,null,null,!1,r["components"],c);o.options.__file="components/wm-poster/wm-posters.vue",t["default"]=o.exports},795:
/*!*********************************************************************************************!*\
  !*** C:/work/haisheng_m/components/wm-poster/wm-posters.vue?vue&type=template&id=781f1a55& ***!
  \*********************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,n){"use strict";n.r(t);var r=n(/*! -!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wm-posters.vue?vue&type=template&id=781f1a55& */796);n.d(t,"render",(function(){return r["render"]})),n.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(t,"components",(function(){return r["components"]}))},796:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/work/haisheng_m/components/wm-poster/wm-posters.vue?vue&type=template&id=781f1a55& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,n){"use strict";var r;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return c})),n.d(t,"recyclableRender",(function(){return i})),n.d(t,"components",(function(){return r}));var a=function(){var e=this,t=e.$createElement;e._self._c},i=!1,c=[];a._withStripped=!0},797:
/*!***************************************************************************************!*\
  !*** C:/work/haisheng_m/components/wm-poster/wm-posters.vue?vue&type=script&lang=js& ***!
  \***************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";n.r(t);var r=n(/*! -!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../software/setup/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wm-posters.vue?vue&type=script&lang=js& */798),a=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a},798:
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/work/haisheng_m/components/wm-poster/wm-posters.vue?vue&type=script&lang=js& ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=i(n(/*! ./node_modules/@vue/babel-preset-app/node_modules/@babel/runtime/regenerator */19));function i(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,a,i,c){try{var u=e[i](c),o=u.value}catch(s){return void n(s)}u.done?t(o):Promise.resolve(o).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function u(e){c(i,r,a,u,o,"next",e)}function o(e){c(i,r,a,u,o,"throw",e)}u(void 0)}))}}var o={name:"wm-poster",props:{CanvasID:{Type:String,default:"PosterCanvas"},imgSrc:{Type:String,default:""},QrSrc:{Type:String,default:""},Title:{Type:String,default:"省钱兄"},TitleColor:{Type:String,default:"#333333"},LineType:{Type:[String,Boolean],default:!0},PriceTxt:{Type:String,default:"99.99"},PriceColor:{Type:String,default:"#e31d1a"},OriginalTxt:{Type:String,default:"199.99"},OriginalColor:{Type:String,default:"#b8b8b8"},Width:{Type:String,default:750},CanvasBg:{Type:String,default:"#ffffff"},Referrer:{Type:String,default:"省钱兄精选好物"},ViewDetails:{Type:String,default:"长按或扫描识别二维码关注"}},data:function(){return{tempFilePath:"",canvasW:0,canvasH:0,canvasImgSrc:"",ctx:null}},methods:{toSave:function(t){e.getImageInfo({src:t,success:function(t){console.log("图片信息：",JSON.stringify(t)),e.saveImageToPhotosAlbum({filePath:t.path,success:function(){console.log("save success"),e.showToast({title:"海报已保存相册",icon:"success",duration:2e3})}})}})},OnCanvas:function(){var t=this;return u(a.default.mark((function n(){var i,c,u,o,s,l,f,d,p,g,x,v,h;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r.ctx=e.createCanvasContext(r.CanvasID,t),i=e.upx2px(r.Width),c=e.upx2px(30),u=e.upx2px(150),o=0,n.next=5,r.getImageInfo({imgSrc:r.imgSrc});case 5:return s=n.sent,n.next=8,r.getImageInfo({imgSrc:r.QrSrc});case 8:l=n.sent,f=[s.width,s.height],d=[l.width,l.height],p=i-2*c,f[0]!=p&&(f[1]=Math.floor(p/f[0]*f[1]),f[0]=p),d[0]!=u&&(d[1]=Math.floor(u/d[0]*d[1]),d[0]=u),r.canvasW=i,r.canvasH=f[1]+d[1]+128,r.ctx.setFillStyle(r.CanvasBg),r.ctx.fillRect(0,0,i,r.canvasH),r.ctx.drawImage(s.path,c,c,f[0],f[1]),r.ctx.setFontSize(e.upx2px(28)),r.ctx.setFillStyle(r.TitleColor),g=0,x=f[1]+2*c+10,v=1,h=0;case 25:if(!(h<r.Title.length)){n.next=47;break}if(o+=r.ctx.measureText(r.Title[h]).width,!(o>f[0])){n.next=43;break}if(2!=v||!r.LineType){n.next=36;break}return r.ctx.fillText(r.Title.substring(g,h-8)+"...",c,x),o=0,g=h,v++,n.abrupt("break",47);case 36:r.ctx.fillText(r.Title.substring(g,h),c,x),o=0,x+=20,g=h,v++;case 41:n.next=44;break;case 43:h==r.Title.length-1&&(r.ctx.fillText(r.Title.substring(g,h+1),c,x),o=0);case 44:h++,n.next=25;break;case 47:x+=e.upx2px(20),r.ctx.drawImage(l.path,f[0]-d[0]+c,x,d[0],d[1]),r.ctx.setFillStyle(r.TitleColor),r.ctx.setFontSize(e.upx2px(30)),r.ctx.fillText(r.Referrer,c,x+d[1]/2),r.ctx.setFillStyle(r.OriginalColor),r.ctx.setFontSize(e.upx2px(24)),r.ctx.fillText(r.ViewDetails,c,x+d[1]/2+20),setTimeout((function(){r.ctx.draw(!0,(function(t){e.hideLoading(),r.getNewImage()}))}),600);case 56:case"end":return n.stop()}}),n)})))()},getImageInfo:function(t){return u(a.default.mark((function n(){var i;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.imgSrc,n.abrupt("return",new Promise((function(t,n){e.getImageInfo({src:i,success:function(e){t(e)},fail:function(t){n(t),e.hideLoading(),r.$queue.showToast("海报生成失败")}})})));case 2:case"end":return n.stop()}}),n)})))()},getNewImage:function(){e.canvasToTempFilePath({canvasId:r.CanvasID,quality:1,complete:function(t){r.tempFilePath=t.tempFilePath,r.$emit("success",t),r.$queue.showToast("长按图片保存海报"),e.hideLoading()}},this)}},mounted:function(){r=this,this.OnCanvas()}};t.default=o}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])}}]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/components/wm-poster/wm-posters.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/wm-poster/wm-posters-create-component',
    {
        'components/wm-poster/wm-posters-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('1')['createComponent'](__webpack_require__(794))
        })
    },
    [['components/wm-poster/wm-posters-create-component']]
]);
